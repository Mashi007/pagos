# üìÑ Gu√≠a: C√≥mo Procesar Documentos en el Sistema RAG

**Fecha:** 2025-01-XX  
**Sistema:** RAPICREDIT - Chat AI

---

## üéØ ¬øQu√© significa "Procesar Documentos"?

**Procesar un documento** significa extraer el texto del archivo (PDF/TXT/DOCX) y guardarlo en la base de datos para que el Chat AI pueda usarlo.

---

## üìã Formas de Procesar Documentos

### **Opci√≥n 1: Procesamiento Autom√°tico (Recomendado)**

**Cu√°ndo ocurre:** Al subir un documento nuevo

**Proceso:**
1. Subes el documento en la pesta√±a "Gesti√≥n de Documentos" (RAGTab)
2. El sistema autom√°ticamente intenta procesarlo
3. Si tiene √©xito, el documento queda procesado inmediatamente

**Ventajas:**
- ‚úÖ Autom√°tico, no requiere acci√≥n adicional
- ‚úÖ Inmediato
- ‚úÖ El documento est√° listo para usar

**Si falla:**
- El documento se guarda pero queda sin procesar
- Puedes procesarlo manualmente despu√©s (Opci√≥n 2)

---

### **Opci√≥n 2: Procesamiento Manual** ‚öôÔ∏è

**Cu√°ndo usar:**
- ‚ùå El procesamiento autom√°tico fall√≥
- üîÑ Quieres reprocesar un documento existente
- üìÑ El documento fue subido pero no se proces√≥

---

#### **üì± Gu√≠a Visual Paso a Paso:**

**Paso 1: Navegar a la Gesti√≥n de Documentos**

```
1. Abre tu navegador y ve a:
   ‚îå‚îÄ> https://rapicredit.onrender.com/configuracion?tab=ai

2. En la interfaz, busca la seci√≥n "Sistema H√≠brido"
   ‚îå‚îÄ> Haz clic en el tab "RAG"

3. Ver√°s la pesta√±a "Gesti√≥n de Documentos"
   ‚îå‚îÄ> Esta es donde est√°n todos tus documentos
```

---

**Paso 2: Identificar Documentos Sin Procesar**

En la lista de documentos, busca documentos con estos indicadores:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìÑ Pol√≠ticas de Pr√©stamos                    ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ ‚îÇ ‚ö†Ô∏è Sin procesar  ‚îÇ Activo ‚îÇ Inactivo ‚îÇ      ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ Descripci√≥n: Documento con pol√≠ticas...              ‚îÇ
‚îÇ üìé politicas.pdf ‚îÇ PDF ‚îÇ 2.5 MB ‚îÇ 2025-01-15 ‚îÇ
‚îÇ                                    [Procesar] [‚úèÔ∏è Editar] [üóëÔ∏è Eliminar] ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Indicadores visuales:**
- ‚ö†Ô∏è **Badge "Sin procesar"** (amarillo con √≠cono AlertCircle) = Necesita procesamiento
- ‚úÖ **Badge "Procesado"** (verde con √≠cono CheckCircle) = Ya procesado
- üîµ **Badge "Activo"** = Documento activo para usar en AI
- üî¥ **Badge "Inactivo"** = Documento no disponible

---

**Paso 3: Procesar el Documento**

```
1. En la fila del documento sin procesar:
   ‚îå‚îÄ> Busca el bot√≥n "Procesar" (√≠cono FileText azul)

2. Haz clic en "Procesar"
   ‚îå‚îÄ> El bot√≥n mostrar√° "Procesando..." con spinner

3. El sistema procesar√° el documento:
   ‚îú‚îÄ> Busca el archivo f√≠sico
   ‚îú‚îÄ> Extrae texto seg√∫n tipo (PDF/TXT/DOCX)
   ‚îú‚îÄ> Limpia y normaliza el texto
   ‚îú‚îÄ> Guarda contenido_texto en BD
   ‚îî‚îÄ> Marca contenido_procesado = true
```

**Durante el procesamiento:**
- ‚è≥ El bot√≥n muestra "Procesando..." con spinner
- üîí El bot√≥n est√° desabilitado para evitar clics m√∫ltiples
- ‚è± Puedes seguir usando otras partes de la interfaz

---

**Paso 4: Verificar √âxito**

Despu√©s de procesar, ver√°s:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìÑ Pol√≠ticas de Pr√©stamos                    ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ ‚îÇ ‚úÖ Procesado  ‚îÇ Activo ‚îÇ Inactivo ‚îÇ      ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ Descripci√≥n: Documento con pol√≠ticas...              ‚îÇ
‚îÇ üìé politicas.pdf ‚îÇ PDF ‚îÇ 2.5 MB ‚îÇ 2025-01-15 ‚îÇ
‚îÇ                                    [‚úèÔ∏è Editar] [üóëÔ∏è Eliminar] ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚úÖ Toast: "Documento procesado exitosamente (15,234 caracteres extra√≠dos)"
```

**Cambios visibles:**
- ‚úÖ Badge "Sin procesar" ‚Üí Badge "Procesado" (verde)
- üìä Mensaje de √©xito con cantidad de caracteres extra√≠dos
- üéØ El documento est√° listo para generar embeddings

---

#### **üîß Ejemplo Completo Visual:**

**Antes de Procesar:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Documentos Existentes                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                            ‚îÇ
‚îÇ üìÑ Manual de Usuario                      ‚îÇ
‚îÇ [‚ö†Ô∏è Sin procesar] [üîµ Activo]        ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ üìé manual.pdf ‚îÇ PDF ‚îÇ 1.2 MB ‚îÇ 2025-01-10 ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ [üìÑ Procesar] [‚úèÔ∏è Editar] [üóëÔ∏è Eliminar] ‚îÇ
‚îÇ                                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Despu√©s de Procesar:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Documentos Existentes                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                            ‚îÇ
‚îÇ üìÑ Manual de Usuario                      ‚îÇ
‚îÇ [‚úÖ Procesado] [üîµ Activo] [‚úÖ Disponible para AI] ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ üìé manual.pdf ‚îÇ PDF ‚îÇ 1.2 MB ‚îÇ 2025-01-10 ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ [‚úèÔ∏è Editar] [üóëÔ∏è Eliminar]                    ‚îÇ
‚îÇ                                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚úÖ Toast: "Documento procesado exitosamente (8,456 caracteres extra√≠dos)"
```

---

#### **‚ö†Ô∏è Mensajes de Error Comunes:**

**Si el archivo no existe:**
```
‚ùå Toast: "El archivo f√≠sico no existe en el servidor. 
Por favor, elimina este documento y s√∫belo nuevamente."

üí° Soluci√≥n: 
1. Elimina el documento desde la interfaz
2. S√∫belo nuevamente
3. El sistema intentar√° procesarlo autom√°ticamente
```

**Si falla la extracci√≥n:**
```
‚ùå Toast: "No se pudo extraer texto del documento 'Manual.pdf'.
El archivo puede estar corrupto, encriptado, o ser un PDF escaneado."

üí° Soluciones:
- Verifica que el PDF tenga texto (no solo im√°genes)
- Si est√° encriptado, desencripta antes de subirlo
- Si es escaneado, convierte a texto primero
```

---

#### **‚úÖ Verificaci√≥n Post-Procesamiento:**

**En la Interfaz:**
- ‚úÖ Badge "Procesado" visible (verde)
- ‚úÖ Mensaje de √©xito con caracteres extra√≠dos
- ‚úÖ Si est√° activo, muestra "‚úÖ Disponible para AI"

**En la Base de Datos:**
```sql
-- Verificar que el documento est√© procesado
SELECT 
    id,
    titulo,
    contenido_procesado,  -- Debe ser TRUE
    LENGTH(contenido_texto) as caracteres_extraidos  -- Debe ser > 0
FROM documentos_ai
WHERE id = {documento_id};

-- Resultado esperado:
-- id | titulo              | contenido_procesado | caracteres_extraidos
-- 1  | Pol√≠ticas Pr√©stamos | true            | 15234
```

#### **Desde la API (Program√°ticamente):**

**Endpoint:** `POST /api/v1/configuracion/ai/documentos/{documento_id}/procesar`

**Ejemplo con cURL:**
```bash
curl -X POST \
  https://rapicredit.onrender.com/api/v1/configuracion/ai/documentos/1/procesar \
  -H "Authorization: Bearer TU_TOKEN"
```

**Ejemplo con Python:**
```python
import requests

url = "https://rapicredit.onrender.com/api/v1/configuracion/ai/documentos/1/procesar"
headers = {"Authorization": "Bearer TU_TOKEN"}

response = requests.post(url, headers=headers)
print(response.json())
```

---

## üîÑ Proceso Completo Paso a Paso

### **Paso 1: Subir Documento**

```
1. Ve a: Configuraci√≥n ‚Üí AI ‚Üí Sistema H√≠brido ‚Üí RAG
2. Pesta√±a: "Gesti√≥n de Documentos"
3. Completa el formulario:
   - T√≠tulo: "Pol√≠ticas de Pr√©stamos"
   - Descripci√≥n: "Documento con pol√≠ticas..."
   - Archivo: Selecciona tu PDF/TXT/DOCX
4. Haz clic en "Subir Documento"
```

**Resultado:**
- ‚úÖ Archivo guardado f√≠sicamente
- ‚úÖ Registro creado en BD
- ‚ö†Ô∏è Estado: "Sin procesar" (si el procesamiento autom√°tico fall√≥)

---

### **Paso 2: Procesar Documento**

**Si el procesamiento autom√°tico fall√≥:**

```
1. En la lista de documentos, encuentra el documento
2. Ver√°s badge "Sin procesar" (amarillo)
3. Haz clic en el bot√≥n "Procesar"
4. Espera el mensaje de √©xito
```

**Lo que hace el sistema:**
```
Usuario hace clic en "Procesar"
    ‚Üì
Frontend: POST /api/v1/configuracion/ai/documentos/{id}/procesar
    ‚Üì
Backend: Busca el archivo f√≠sico
    ‚Üì
Backend: Detecta tipo de archivo (PDF/TXT/DOCX)
    ‚Üì
Backend: Extrae texto seg√∫n tipo:
    - PDF ‚Üí PyPDF2 o pdfplumber
    - TXT ‚Üí Lectura directa
    - DOCX ‚Üí python-docx
    ‚Üì
Backend: Limpia y normaliza el texto
    ‚Üì
Backend: Guarda contenido_texto en BD
    ‚Üì
Backend: Marca contenido_procesado = true
    ‚Üì
‚úÖ Documento procesado exitosamente
```

---

### **Paso 3: Verificar Procesamiento**

**En la interfaz:**
- ‚úÖ Badge "Procesado" (verde) = Documento procesado correctamente
- ‚úÖ Badge "Sin procesar" (amarillo) = Necesita procesamiento

**En la base de datos:**
```sql
-- Ver documentos procesados
SELECT id, titulo, contenido_procesado, 
       LENGTH(contenido_texto) as caracteres
FROM documentos_ai
WHERE contenido_procesado = true;

-- Ver documentos sin procesar
SELECT id, titulo, contenido_procesado
FROM documentos_ai
WHERE contenido_procesado = false;
```

---

## ‚öôÔ∏è Requisitos para Procesar

### **1. Archivo F√≠sico Disponible**
- El archivo debe existir en el servidor
- Ruta: `uploads/documentos_ai/` (o seg√∫n configuraci√≥n)

### **2. Herramientas Adicionales Requeridas** ‚ö†Ô∏è

**‚ö†Ô∏è IMPORTANTE:** Necesitas instalar herramientas adicionales seg√∫n el tipo de archivo:

| Tipo Archivo | Herramienta Requerida | Instalaci√≥n |
|--------------|----------------------|------------|
| **TXT** | Ninguna | ‚úÖ Ya disponible |
| **PDF** | PyPDF2 **O** pdfplumber | `pip install PyPDF2 pdfplumber` |
| **DOCX** | python-docx | `pip install python-docx` |

**Instalaci√≥n completa recomendada:**
```bash
pip install PyPDF2 pdfplumber python-docx
```

**üìö Gu√≠a completa:** Ver `Documentos/Guia/HERRAMIENTAS_PROCESAMIENTO_DOCUMENTOS.md` para detalles de instalaci√≥n, verificaci√≥n y troubleshooting.

### **3. Permisos**
- Solo administradores pueden procesar documentos
- El usuario debe tener `is_admin = true`

---

## üîç Verificaci√≥n del Procesamiento

### **Desde la Interfaz:**

1. **Ver estado del documento:**
   - Badge "Procesado" = ‚úÖ Procesado
   - Badge "Sin procesar" = ‚ùå No procesado

2. **Ver informaci√≥n:**
   - El documento procesado mostrar√° informaci√≥n del archivo
   - Si est√° procesado, puedes generar embeddings

### **Desde el Backend:**

**Verificar en logs:**
```
‚úÖ Documento procesado: {titulo}
   Caracteres extra√≠dos: {cantidad}
   Contenido guardado en BD (disponible para entrenamiento)
```

**Verificar en BD:**
```sql
SELECT 
    id,
    titulo,
    contenido_procesado,
    CASE 
        WHEN contenido_texto IS NOT NULL 
        THEN LENGTH(contenido_texto) 
        ELSE 0 
    END as caracteres_extraidos
FROM documentos_ai
ORDER BY creado_en DESC;
```

---

## ‚ö†Ô∏è Problemas Comunes y Soluciones

### **Problema 1: "Archivo no encontrado"**

**Causa:** El archivo f√≠sico desapareci√≥ (sistemas ef√≠meros como Render)

**Soluci√≥n:**
1. Elimina el documento desde la interfaz
2. S√∫belo nuevamente
3. El sistema intentar√° procesarlo autom√°ticamente

---

### **Problema 2: "No se pudo extraer texto"**

**Causas posibles:**
- PDF encriptado con contrase√±a
- PDF escaneado (solo im√°genes, sin texto)
- Archivo corrupto
- Dependencias no instaladas

**Soluciones:**

**Para PDF encriptado:**
- Desencripta el PDF antes de subirlo
- O usa un PDF sin protecci√≥n

**Para PDF escaneado:**
- Necesitar√≠as OCR (no implementado actualmente)
- Convierte el PDF escaneado a texto primero

**Para dependencias faltantes:**
```bash
# Instalar dependencias
pip install PyPDF2 python-docx pdfplumber
```

---

### **Problema 3: "Documento procesado pero sin contenido"**

**Causa:** El archivo est√° vac√≠o o no tiene texto extra√≠ble

**Soluci√≥n:**
- Verifica que el archivo tenga contenido
- Intenta con otro formato (ej: convertir PDF a TXT)

---

## üìä Estados de un Documento

| Estado | `contenido_procesado` | `contenido_texto` | Acciones Disponibles |
|--------|----------------------|-------------------|---------------------|
| **Subido** | `false` | `null` | Procesar manualmente |
| **Procesado** | `true` | Texto completo | ‚úÖ Generar embeddings<br>‚úÖ Usar en Chat AI |
| **Con Embeddings** | `true` | Texto completo | ‚úÖ B√∫squeda sem√°ntica<br>‚úÖ Chat AI mejorado |

---

## üéØ Flujo Completo Recomendado

```
1. SUBIR DOCUMENTO
   ‚îî‚îÄ> Sistema intenta procesar autom√°ticamente
       ‚îú‚îÄ> ‚úÖ √âxito ‚Üí Documento procesado
       ‚îî‚îÄ> ‚ùå Falla ‚Üí Documento sin procesar

2. PROCESAR MANUALMENTE (si fall√≥)
   ‚îî‚îÄ> Click en "Procesar"
       ‚îî‚îÄ> ‚úÖ √âxito ‚Üí Documento procesado

3. VERIFICAR PROCESAMIENTO
   ‚îî‚îÄ> Badge "Procesado" (verde)
       ‚îî‚îÄ> ‚úÖ Listo para siguiente paso

4. GENERAR EMBEDDINGS (Opcional)
   ‚îî‚îÄ> Pesta√±a "Embeddings y B√∫squeda"
       ‚îî‚îÄ> Click en "Generar Embeddings"
           ‚îî‚îÄ> ‚úÖ Embeddings generados

5. USAR EN CHAT AI
   ‚îî‚îÄ> El Chat AI usa autom√°ticamente documentos procesados
       ‚îî‚îÄ> ‚úÖ Respuestas mejoradas con contexto
```

---

## üí° Consejos y Mejores Pr√°cticas

### **1. Formato de Archivos**
- ‚úÖ **PDF:** Mejor si es PDF con texto (no escaneado)
- ‚úÖ **TXT:** M√°s r√°pido de procesar
- ‚úÖ **DOCX:** Funciona bien con python-docx

### **2. Tama√±o de Archivos**
- ‚úÖ M√°ximo recomendado: 10MB
- ‚úÖ Archivos grandes pueden tardar m√°s en procesar

### **3. Procesamiento Autom√°tico**
- ‚úÖ Siempre intenta procesar autom√°ticamente al subir
- ‚úÖ Si falla, procesa manualmente despu√©s
- ‚úÖ El contenido se guarda en BD (no depende del archivo f√≠sico)

### **4. Verificaci√≥n**
- ‚úÖ Verifica que el documento tenga badge "Procesado"
- ‚úÖ Revisa los logs si hay problemas
- ‚úÖ Verifica en BD que `contenido_texto` no est√© vac√≠o

---

## üîó Endpoints Relacionados

| Acci√≥n | Endpoint | M√©todo |
|--------|----------|--------|
| **Subir documento** | `/api/v1/configuracion/ai/documentos` | POST |
| **Procesar documento** | `/api/v1/configuracion/ai/documentos/{id}/procesar` | POST |
| **Listar documentos** | `/api/v1/configuracion/ai/documentos` | GET |
| **Ver documento** | `/api/v1/configuracion/ai/documentos/{id}` | GET |
| **Eliminar documento** | `/api/v1/configuracion/ai/documentos/{id}` | DELETE |

---

---

## üîß Troubleshooting Espec√≠fico: Procesamiento Manual

### **Problema: El bot√≥n "Procesar" no aparece**

**Causas posibles:**
- El documento ya est√° procesado (`contenido_procesado = true`)
- No tienes permisos de administrador
- Error de carga de documentos

**Soluciones:**

**Si el documento ya est√° procesado:**
- ‚úÖ No necesitas procesarlo nuevamente
- ‚úÖ Puedes generar embeddings directamente
- ‚úÖ El Chat AI ya puede usarlo

**Si no tienes permisos:**
- üîí Solo administradores pueden procesar documentos
- üìß Contacta al administrador del sistema

**Si hay error de carga:**
- üîÑ Recarga la p√°gina (F5)
- üîÑ Verifica tu conexi√≥n a internet
- üìß Revisa la consola del navegador (F12) para errores

---

### **Problema: El procesamiento tarda mucho**

**Causas:**
- Archivo muy grande (>10MB)
- Servidor lento o sobrecargado
- Proceso de extracci√≥n complejo (PDF con muchas im√°genes)

**Soluciones:**
- ÔøΩÔ∏è Espera a que termine (puede tardar varios minutos)
- üìä Verifica el progreso en los logs del servidor
- üîÑ Si falla despu√©s de mucho tiempo, intenta con un archivo m√°s peque√±o

---

### **Problema: "Procesado" pero sin contenido**

**Verificaci√≥n:**
```sql
SELECT 
    id,
    titulo,
    contenido_procesado,
    CASE 
        WHEN contenido_texto IS NULL THEN 'NULL'
        WHEN contenido_texto = '' THEN 'VAC√çO'
        ELSE CONCAT('OK: ', LENGTH(contenido_texto), ' caracteres')
    END as estado_contenido
FROM documentos_ai
WHERE id = {documento_id};
```

**Si el contenido est√° NULL o VAC√çO:**
- ‚ùå El procesamiento fall√≥ silenciosamente
- üîÑ Intenta procesarlo nuevamente
- üìß Si persiste, el archivo puede estar corrupto o vac√≠o

---

## ‚úÖ Resumen Ejecutivo

### **üìã Formas de Procesar:**

| M√©todo | Cu√°ndo Usar | Ventajas |
|--------|--------------|----------|
| **Autom√°tico** | Al subir documento | ‚úÖ Inmediato<br>‚úÖ Sin acci√≥n adicional |
| **Manual** | Si falla autom√°tico<br>Reprocesar existente | ‚úÖ Control total<br>‚úÖ Verificaci√≥n expl√≠cita |

---

### **üéØ Pasos R√°pidos:**

**Procesamiento Autom√°tico:**
```
1. Sube documento ‚Üí Sistema procesa autom√°ticamente ‚Üí ‚úÖ Listo
```

**Procesamiento Manual:**
```
1. Ve a: Configuraci√≥n ‚Üí AI ‚Üí RAG ‚Üí Gesti√≥n Documentos
2. Busca documento con badge "‚ö†Ô∏è Sin procesar"
3. Haz clic en bot√≥n "üìÑ Procesar"
4. Espera mensaje de √©xito ‚Üí ‚úÖ Badge cambia a "Procesado"
```

---

### **üìä Resultado Final:**

Despu√©s de procesar (autom√°tico o manual):

‚úÖ **Estado en BD:**
- `contenido_procesado = true`
- `contenido_texto` = Texto completo extra√≠do
- Documento disponible para Chat AI

‚úÖ **Estado en Interfaz:**
- Badge "‚úÖ Procesado" (verde)
- Si est√° activo: "‚úÖ Disponible para AI"
- Bot√≥n "Procesar" desaparece (ya no es necesario)

‚úÖ **Siguiente Paso (Opcional):**
- Generar embeddings para b√∫squeda sem√°ntica
- Activar documento si no est√° activo
- Usar en Chat AI (autom√°tico si est√° activo)

---

**üéØ El procesamiento convierte archivos f√≠sicos (PDF/TXT/DOCX) en texto utilizable por el Chat AI, guard√°ndolo permanentemente en la base de datos.**
